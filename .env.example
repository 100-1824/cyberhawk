# ============================================================================
# CyberHawk Environment Configuration
# ============================================================================
# Copy this file to .env and update with your actual values
# DO NOT commit .env to version control!
# ============================================================================

# ----------------------------------------------------------------------------
# DATABASE CONFIGURATION
# ----------------------------------------------------------------------------
DB_HOST=localhost
DB_PORT=3306
DB_DATABASE=cyberhawk
DB_USERNAME=root
DB_PASSWORD=
DB_CHARSET=utf8mb4
DB_COLLATION=utf8mb4_unicode_ci

# ----------------------------------------------------------------------------
# APPLICATION CONFIGURATION
# ----------------------------------------------------------------------------
APP_NAME="CyberHawk IDPS"
APP_ENV=local
APP_DEBUG=true
APP_URL=http://localhost/cyberhawk/
APP_TIMEZONE=Asia/Karachi

# Application paths
APP_DIR=/path/to/cyberhawk/
MDIR=/cyberhawk/

# ----------------------------------------------------------------------------
# SESSION CONFIGURATION
# ----------------------------------------------------------------------------
SESSION_LIFETIME=120
SESSION_COOKIE_NAME=cyberhawk_session
SESSION_SECURE=false
SESSION_HTTP_ONLY=true
SESSION_SAME_SITE=lax

# ----------------------------------------------------------------------------
# SECURITY SETTINGS
# ----------------------------------------------------------------------------
# Bcrypt cost (higher = more secure but slower, recommended: 10-12)
BCRYPT_COST=10

# Password requirements
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL=true

# Maximum login attempts before lockout
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION=900

# CSRF Token
CSRF_TOKEN_NAME=cyberhawk_csrf_token

# ----------------------------------------------------------------------------
# API KEYS - EXTERNAL THREAT INTELLIGENCE
# ----------------------------------------------------------------------------

# VirusTotal API Key
# Get your free API key from: https://www.virustotal.com/gui/join-us
VIRUSTOTAL_API_KEY=your_virustotal_api_key_here

# MalwareBazaar API (abuse.ch)
# No API key required, but rate limits apply
MALWAREBAZAAR_API_URL=https://mb-api.abuse.ch/api/v1/

# ThreatFox API (abuse.ch)
# No API key required
THREATFOX_API_URL=https://threatfox-api.abuse.ch/api/v1/

# AbuseIPDB API Key (optional)
# Get API key from: https://www.abuseipdb.com/
ABUSEIPDB_API_KEY=your_abuseipdb_api_key_here

# ----------------------------------------------------------------------------
# MACHINE LEARNING CONFIGURATION
# ----------------------------------------------------------------------------

# IDS Model Settings
IDS_MODEL_PATH=python/training/models/ids_model.h5
IDS_MODEL_CONFIDENCE_THRESHOLD=0.85
IDS_FEATURE_COUNT=49

# Malware Detection Model
MALWARE_MODEL_PATH=python/malware/models/malware_model.h5
MALWARE_CONFIDENCE_THRESHOLD=0.80

# Ransomware Detection Model
RANSOMWARE_MODEL_PATH=python/ranswomware/models/ransomware_model.h5
RANSOMWARE_ENTROPY_THRESHOLD=7.5
RANSOMWARE_CONFIDENCE_THRESHOLD=0.85

# ----------------------------------------------------------------------------
# NETWORK MONITORING CONFIGURATION
# ----------------------------------------------------------------------------

# Default network interface (leave empty for auto-detection)
DEFAULT_NETWORK_INTERFACE=

# Packet capture settings
PACKET_CAPTURE_TIMEOUT=5
MAX_PACKETS_PER_BATCH=1000
FLOW_AGGREGATION_WINDOW=60

# Traffic log retention (days)
TRAFFIC_LOG_RETENTION_DAYS=30

# ----------------------------------------------------------------------------
# FILE UPLOAD SETTINGS
# ----------------------------------------------------------------------------

# Maximum upload file size (in MB)
MAX_UPLOAD_SIZE_MB=50

# Allowed file extensions for malware analysis
ALLOWED_UPLOAD_EXTENSIONS=exe,dll,sys,bin,bat,cmd,ps1,vbs,jar,apk,elf,so,dylib,app

# Upload directory
UPLOAD_DIR=uploads/samples/

# Quarantine directory
QUARANTINE_DIR=quarantine/

# ----------------------------------------------------------------------------
# RANSOMWARE MONITORING
# ----------------------------------------------------------------------------

# Default paths to monitor (comma-separated)
DEFAULT_MONITORED_PATHS=/home/user/Documents,/home/user/Desktop

# Suspicious file extensions (comma-separated)
SUSPICIOUS_EXTENSIONS=.encrypted,.locky,.cerber,.zepto,.cryptolocker,.cryptowall,.teslacrypt,.wannacry,.petya,.ryuk,.sodinokibi,.maze,.egregor,.lockbit

# Auto-quarantine on critical threat
AUTO_QUARANTINE_ENABLED=true

# Backup settings
BACKUP_ENABLED=true
BACKUP_DIR=backups/
BACKUP_RETENTION_DAYS=7

# ----------------------------------------------------------------------------
# EMAIL CONFIGURATION
# ----------------------------------------------------------------------------

# SMTP Settings for email notifications
MAIL_MAILER=smtp
MAIL_HOST=smtp.gmail.com
MAIL_PORT=587
MAIL_USERNAME=your-email@gmail.com
MAIL_PASSWORD=your-app-password
MAIL_ENCRYPTION=tls
MAIL_FROM_ADDRESS=noreply@cyberhawk.local
MAIL_FROM_NAME="CyberHawk Security System"

# Email notification settings
SEND_ALERT_EMAILS=true
ALERT_EMAIL_RECIPIENTS=admin@company.com,security@company.com

# Email templates
EMAIL_TEMPLATE_DIR=app/views/emails/

# ----------------------------------------------------------------------------
# LOGGING CONFIGURATION
# ----------------------------------------------------------------------------

# Log levels: debug, info, warning, error, critical
LOG_LEVEL=info

# Log file paths
LOG_DIR=logs/
APP_LOG_FILE=app.log
ERROR_LOG_FILE=error.log
AUDIT_LOG_FILE=audit.log

# Log rotation
LOG_MAX_SIZE_MB=10
LOG_MAX_FILES=10

# ----------------------------------------------------------------------------
# REPORTING CONFIGURATION
# ----------------------------------------------------------------------------

# Report generation
REPORT_OUTPUT_DIR=reports/
DEFAULT_REPORT_FORMAT=html
PDF_GENERATION_ENABLED=true

# Report retention (days)
REPORT_RETENTION_DAYS=90

# ----------------------------------------------------------------------------
# NOTIFICATION SETTINGS
# ----------------------------------------------------------------------------

# In-app notifications
NOTIFICATION_ENABLED=true
NOTIFICATION_RETENTION_DAYS=30
NOTIFICATION_MAX_PER_USER=100

# Push notifications (future feature)
PUSH_NOTIFICATIONS_ENABLED=false

# ----------------------------------------------------------------------------
# PERFORMANCE TUNING
# ----------------------------------------------------------------------------

# Cache settings
CACHE_ENABLED=true
CACHE_DRIVER=file
CACHE_TTL=3600

# Database connection pooling
DB_POOL_MIN=5
DB_POOL_MAX=20

# Background jobs
ENABLE_BACKGROUND_JOBS=true
MAX_CONCURRENT_SCANS=3

# ----------------------------------------------------------------------------
# DEVELOPMENT & DEBUGGING
# ----------------------------------------------------------------------------

# Enable debug mode (NEVER enable in production!)
DEBUG_MODE=false

# Display detailed errors
DISPLAY_ERRORS=false

# SQL query logging
LOG_SQL_QUERIES=false

# Python script debugging
PYTHON_DEBUG=false

# ----------------------------------------------------------------------------
# AZURE SSO CONFIGURATION (OPTIONAL - Not Implemented)
# ----------------------------------------------------------------------------

# Azure Active Directory Settings
AZURE_CLIENT_ID=your_azure_client_id
AZURE_CLIENT_SECRET=your_azure_client_secret
AZURE_TENANT_ID=your_azure_tenant_id
AZURE_REDIRECT_URI=http://localhost/cyberhawk/AzureCallback

# ----------------------------------------------------------------------------
# THIRD-PARTY INTEGRATIONS (OPTIONAL)
# ----------------------------------------------------------------------------

# Slack Webhook for alerts
SLACK_WEBHOOK_URL=

# Microsoft Teams Webhook
TEAMS_WEBHOOK_URL=

# Syslog server
SYSLOG_ENABLED=false
SYSLOG_HOST=
SYSLOG_PORT=514

# ----------------------------------------------------------------------------
# RATE LIMITING
# ----------------------------------------------------------------------------

# API rate limits (requests per minute)
RATE_LIMIT_API=60
RATE_LIMIT_LOGIN=5
RATE_LIMIT_UPLOAD=10

# ----------------------------------------------------------------------------
# MAINTENANCE MODE
# ----------------------------------------------------------------------------

# Enable maintenance mode
MAINTENANCE_MODE=false
MAINTENANCE_MESSAGE="System under maintenance. Please check back later."

# ============================================================================
# END OF CONFIGURATION
# ============================================================================
