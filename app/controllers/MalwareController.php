<?php

/**
 * MalwareController Class
 *
 * Purpose: Handles malware detection related HTTP requests
 * Delegates business logic to MalwareService
 */
class MalwareController {

    private $malwareService;

    /**
     * Constructor
     */
    public function __construct() {
        $this->malwareService = new MalwareService();
    }

    /**
     * Show malware page
     *
     * @param array $vars Route variables
     * @return void
     */
    public function show($vars = []) {
        if (!isset($_SESSION['user_id'])) {
            header("Location: " . MDIR . "login");
            exit;
        }
        require 'app/views/pages/malware.php';
    }

    /**
     * Upload malware sample
     *
     * @param array $vars Route variables
     * @return void JSON response
     */
    public function uploadSample($vars = []) {
        return $this->malwareService->uploadSample();
    }

    /**
     * Start malware scan
     *
     * @param array $vars Route variables
     * @return void JSON response
     */
    public function startScan($vars = []) {
        return $this->malwareService->startScan();
    }

    /**
     * Get scan progress
     *
     * @param array $vars Route variables
     * @return void JSON response
     */
    public function getScanProgress($vars = []) {
        return $this->malwareService->getScanProgress();
    }

    /**
     * Get malware report
     *
     * @param array $vars Route variables
     * @return void JSON response
     */
    public function getReport($vars = []) {
        return $this->malwareService->getReport();
    }

    /**
     * Get all malware reports
     *
     * @param array $vars Route variables
     * @return void JSON response
     */
    public function getAllReports($vars = []) {
        return $this->malwareService->getAllReports();
    }

    /**
     * Get malware statistics
     *
     * @param array $vars Route variables
     * @return void JSON response
     */
    public function getStats($vars = []) {
        return $this->malwareService->getStats();
    }

    /**
     * Get scan queue
     *
     * @param array $vars Route variables
     * @return void JSON response
     */
    public function getScanQueue($vars = []) {
        return $this->malwareService->getScanQueue();
    }

    /**
     * Delete malware sample
     *
     * @param array $vars Route variables
     * @return void JSON response
     */
    public function deleteSample($vars = []) {
        return $this->malwareService->deleteSample();
    }

    /**
     * Export malware report
     *
     * @param array $vars Route variables
     * @return void File download
     */
    public function exportReport($vars = []) {
        return $this->malwareService->exportReport();
    }
}

?>
